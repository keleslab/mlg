library(Seurat)
n
R.home()
library(Seurat)
FindClusters
library(knitr)
install.packages("pdfCluster")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("devtools")
devtools::install_github('MacoskoLab/liger')
install.packages("riverplot")
install.packages("Hmisc")
install.packages("foreach")
install.packages("snow")
install.packages("doSNOW")
install.packages("mclust")
install.packages("psych")
install.packages("cowplot")
library(mlg)
library(ggplot2)
library(cowplot)
library(Seurat)
library(Seurat)
library(liger)
library(mlg)
library(pdfCluster)
library(mclust)
data("kowalczyk_1", package = "mlg")
# number of component to be kept for each dimension reduction method
num_component <- 15
# generate Seurat object
seurat.obj <- CreateSeuratObject(counts = gene_expression_matrix,
project = "seurat.obj",
assay = "RNA",
meta.data = cell_info)
# Seurat integration
condition.list <- SplitObject(seurat.obj, split.by = "condition_label")
liger.obj <- createLiger(list(young = condition.list[[1]]@assays$RNA@counts,
old = condition.list[[2]]@assays$RNA@counts))
liger.obj <- liger::normalize(liger.obj)
liger.obj <- selectGenes(liger.obj, var.thresh = .7281) # keep 3000 genes, check in length(liger.obj@var.genes)
liger.obj <- scaleNotCenter(liger.obj)
liger.obj <- optimizeALS(liger.obj, k = num_component)
liger.obj <- optimizeALS(liger.obj, k = num_component)
liger.obj <- louvainCluster(liger.obj, resolution = 0.4)
liger.obj <- quantile_norm(liger.obj)
liger.obj <- louvainCluster(liger.obj, resolution = 0.4)
unique(liger.obj@clusters)
liger.obj <- louvainCluster(liger.obj, resolution = 0.2)
unique(liger.obj@clusters)
liger.obj <- runTSNE(liger.obj)
## prepare liger factors for MLG clustering
# reordering and scaling of raw liger factors
liger_factor <- rbind(liger.obj@H$young,liger.obj@H$old)
# reorder the cells, so that the cell order are the same as in original data
liger_factor <- liger_factor[rownames(cell_info), ]
# scale the penalized NMF score for each cell, so that they sums to 1
liger_factor <- t(apply(liger_factor, 1, function(i){i/sum(i)}))
tSNE_coord_Liger <- data.frame(liger.obj@tsne.coords)
colnames(tSNE_coord_Liger) <- c("tSNE_1", "tSNE_2")
# Visualization of the dataset on tSNE coordinates
plot_grid(ggplot(tSNE_coord_Liger, aes(tSNE_1, tSNE_2, color = cell_info$cell_type_label))+
geom_point() + labs(color = "cell type") + theme(legend.position = "bottom"),
ggplot(tSNE_coord_Liger, aes(tSNE_1, tSNE_2, color = liger.obj@clusters)) +
labs(color = "cluster") + theme(legend.position = "bottom") + geom_point())
# The Adjusted Rand Index(ARI) of the Liger clustering
pdfCluster::adj.rand.index(liger.obj@clusters, cell_info$cell_type_label)
# Visualization of the dataset on tSNE coordinates
plot_grid(ggplot(tSNE_coord_Liger, aes(tSNE_1, tSNE_2, color = cell_info$cell_type_label))+
geom_point() + labs(color = "cell type") + theme(legend.position = "bottom"),
ggplot(tSNE_coord_Liger, aes(tSNE_1, tSNE_2, color = liger.obj@clusters)) +
labs(color = "cluster") + theme(legend.position = "bottom") + geom_point())
mclust::adjustedRandIndex(liger.obj@clusters, cell_info$cell_type_label)
devtools::document()
getwd()
getwd('~/Documents/mlg/')
setwd('~/Documents/mlg/')
setwd('~/Documents/mlg/mlg/')
devtools::document()
